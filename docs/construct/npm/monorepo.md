# Monorepo

## 什么是 Monorepo

Monorepo（单一仓库）是一种架构模式，将多个相关项目（如前端、后端、共享库等）放在同一个 Git 仓库中管理。

### 特点

- **代码共享**：共享类型定义、工具配置、组件库等
- **统一依赖管理**：使用 workspace 功能管理依赖
- **原子性提交**：跨项目的更改可以在一次提交中完成
- **统一 CI/CD**：可以在一个流水线中处理所有项目

---

## 常见的 Monorepo 工具对比

| 工具                 | 优点                                                                                                                                                 | 缺点                                                                                     |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| **pnpm workspaces**  | - 磁盘空间效率极高（硬链接共享依赖）<br>- 安装速度最快<br>- 严格依赖管理，避免幽灵依赖<br>- 配置简单，学习成本低<br>- 内置 workspace 支持            | - 缺少高级构建优化（如缓存、并行构建）<br>- 没有代码生成器和脚手架<br>- 缺少可视化工具   |
| **Nx**               | - 智能构建缓存和增量构建<br>- 强大的依赖图分析<br>- 丰富的插件生态（React、Angular、Node.js 等）<br>- 代码生成器和最佳实践支持<br>- 优秀的可视化工具 | - 学习曲线陡峭<br>- 配置复杂<br>- 对项目结构有较强约束<br>- 体积较大                     |
| **Turborepo**        | - 出色的构建缓存和并行执行<br>- 配置简单，易于集成<br>- 轻量级，专注构建优化<br>- 良好的 CI/CD 集成                                                  | - 功能相对单一（主要是构建优化）<br>- 生态系统较新，插件较少<br>- 缺少代码生成等开发工具 |
| **Lerna + Yarn/npm** | - 历史悠久，生态成熟<br>- 灵活性高，可自由配置<br>- 与现有工具集成良好                                                                               | - 配置复杂，需要多个工具配合<br>- 性能一般<br>- 维护成本高<br>- Lerna 已进入维护模式     |
| **Rush**             | - 企业级特性（严格版本管理）<br>- 增量构建支持<br>- 详细的构建日志                                                                                   | - 主要针对大型企业项目<br>- 学习成本高<br>- 社区相对较小                                 |

---

## 推荐选择

- **小中型项目**：`pnpm workspaces`
- **需要构建优化**：`Turborepo + pnpm`
- **复杂企业应用**：`Nx`
- **已有项目迁移**：`Rush`
